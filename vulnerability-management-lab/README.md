# Vulnerability Management Lab ( ** Template ** )

A practical demonstration of vulnerability assessment, risk prioritization, and remediation validation using industry-standard tools.

## Objective

Simulate a real-world vulnerability management workflow:
1. Discover and scan vulnerable systems
2. Analyze and prioritize findings based on risk
3. Remediate critical vulnerabilities
4. Validate fixes through re-scanning

## Lab Environment

**Target Systems:**
- Metasploitable 2 (deliberately vulnerable Linux VM)
- Windows 10 VM (unpatched, EOL software installed)

**Scanning Tools:**
- OpenVAS (Greenbone Vulnerability Management)
- Nessus Essentials (alternative/comparison scans)

**Network:** Isolated virtual network (NAT mode, no internet exposure)

## Scan Summary

### Initial Scan Results

| Severity | Count | Examples |
|----------|-------|----------|
| Critical | 12 | vsftpd 2.3.4 backdoor, UnrealIRCd backdoor |
| High | 28 | OpenSSL vulnerabilities, Apache misconfigurations |
| Medium | 45 | Outdated packages, weak ciphers |
| Low | 63 | Information disclosure, banner grabbing |

**Total Vulnerabilities Found:** 148

### Key Findings

**Critical Vulnerabilities Identified:**

1. **vsftpd 2.3.4 Backdoor (CVE-2011-2523)**
   - CVSS Score: 10.0
   - Impact: Remote code execution without authentication
   - Affected System: Metasploitable 2 (192.168.1.100)

2. **Unpatched SMBv1 (MS17-010 / EternalBlue)**
   - CVSS Score: 9.3
   - Impact: Remote code execution, wormable
   - Affected System: Windows 10 VM (192.168.1.101)

3. **Distcc Daemon Command Execution**
   - CVSS Score: 9.3
   - Impact: Arbitrary command execution
   - Affected System: Metasploitable 2

See [reports/vulnerability-assessment-report.md](reports/vulnerability-assessment-report.md) for full technical details.

## Remediation Process

### Risk-Based Prioritization

Remediation order based on:
- CVSS score (Critical > High > Medium)
- Exploitability (public exploits available?)
- System criticality (production vs lab)
- Ease of remediation

### Actions Taken

**Phase 1: Critical Vulnerabilities (Week 1)**
- Removed vsftpd 2.3.4, installed vsftpd 3.0.3
- Disabled SMBv1 protocol on Windows 10
- Disabled distcc service, removed from startup
- Applied all Windows security patches (KB updates listed in remediation/patching-log.md)

**Phase 2: High Vulnerabilities (Week 2)**
- Updated OpenSSL from 0.9.8 to 1.1.1
- Reconfigured Apache SSL/TLS settings (disabled SSLv3, weak ciphers)
- Updated PHP from 5.2 to 7.4

See [remediation/fixes-applied.sh](remediation/fixes-applied.sh) for commands used.

## Validation

### Re-scan Results (Post-Remediation)

| Severity | Before | After | Reduction |
|----------|--------|-------|-----------|
| Critical | 12 | 0 | 100% |
| High | 28 | 3 | 89% |
| Medium | 45 | 18 | 60% |
| Low | 63 | 42 | 33% |

**Remaining High Vulnerabilities:**
- All related to legacy services required for lab functionality
- Risk accepted with compensating controls (network isolation, no external access)
- Documented in risk acceptance log

### Evidence

![Initial Critical Findings](evidence/screenshots/critical-vulns.png)
*Screenshot showing 12 critical vulnerabilities in initial scan*

![Post-Remediation Scan](evidence/screenshots/final-scan-clean.png)
*Screenshot showing 0 critical vulnerabilities after remediation*

## Skills Demonstrated

- Vulnerability scanning and assessment using enterprise tools
- CVSS scoring interpretation and risk prioritization
- Patch management and system hardening
- Remediation validation through re-scanning
- Technical report writing for management and technical audiences
- Understanding of common vulnerability classes (RCE, privilege escalation, information disclosure)

## Tools Used

- **OpenVAS 21.4** - Primary vulnerability scanner
- **Nessus Essentials** - Comparison scanning
- **Metasploitable 2** - Vulnerable target environment
- **VirtualBox** - Virtualization platform
- **Bash/PowerShell** - Remediation scripting

## Lessons Learned

**Key Takeaways:**
- Prioritization is critical - can't patch everything at once
- Some vulnerabilities require application removal, not just patching
- Re-scanning is essential to validate fixes actually worked
- False positives exist - manual validation required for ~10% of findings
- Dependency management is complex (updating one package can break others)

**Challenges Faced:**
- OpenVAS initial setup was complex (resolved using Greenbone Docker containers)
- Some Metasploitable services broke when updated (intentional for lab)
- Windows Update initially failed (required manual KB download)

## Future Enhancements

- Integrate with Defect Dojo for vulnerability tracking
- Automate scanning with cron jobs + email alerts
- Create custom OpenVAS scan configs for faster targeted scans
- Add compliance scanning (CIS benchmarks, STIG checks)
- Build remediation playbooks for common vulnerability types

## References

- [OpenVAS Documentation](https://docs.greenbone.net/)
- [NIST National Vulnerability Database](https://nvd.nist.gov/)
- [FIRST CVSS Calculator](https://www.first.org/cvss/calculator/3.1)
- [SANS Vulnerability Management Process](https://www.sans.org/white-papers/)

---

**Author:** Tigris Mendez
**Date:** February 2026  
**Certifications:** CompTIA Security+  
**Contact:** [GitHub Profile](https://github.com/uploadtigris) [LinkedIn](https://www.linkedin.com/in/tigrismendez/)
